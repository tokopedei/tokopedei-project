{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\Ecommerce-Project\\\\front-end\\\\src\\\\components\\\\main\\\\shelf\\\\products\\\\Products.jsx\",\n    _s = $RefreshSig$();\n\nimport './Products.css';\nimport './ProductQueries.css';\nimport React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useLocation } from 'react-router-dom';\nimport { Image } from 'cloudinary-react';\nimport { IoAddOutline, IoRemoveOutline } from 'react-icons/io5';\nimport AddModal from '../addModal/AddModal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Products = () => {\n  _s();\n\n  const [categoryId, setCategoryId] = useState(0);\n  const arr = useSelector(state => state.getProducts);\n  const openCart = useSelector(state => state.getOpenCart);\n  const objProductCart = useSelector(state => state.getProductCart);\n  const searchStatus = useSelector(state => state.getSearchStatus);\n  const addModalState = useSelector(state => state.getAddModalState);\n  const disabledBg = useSelector(state => state.getDisabledBg);\n  const dispatch = useDispatch();\n  const location = useLocation();\n\n  const axios = require('axios');\n\n  useEffect(() => {\n    // Fetch first category dynamically\n    (async () => {\n      try {\n        const res = await axios.get('http://localhost:3001/category');\n        setCategoryId(res.data.category.id);\n      } catch (err) {\n        console.error(err);\n      }\n    })();\n  }, [axios]);\n  useEffect(() => {\n    // Fetch category dynamically\n    (async () => {\n      try {\n        const res = await axios.get(`http://localhost:3001/products/${location.id ? location.id : categoryId}`);\n        const found = res.data.data.find(firstProduct => firstProduct);\n\n        if (found) {\n          dispatch({\n            type: 'SET_PRODUCT',\n            product: found\n          });\n          dispatch({\n            type: 'SET_PRODUCTS',\n            products: res.data.data\n          });\n          dispatch({\n            type: 'SET_SEARCH_STATUS',\n            searchStatus: null\n          });\n        }\n      } catch (err) {\n        console.error(err);\n      }\n    })();\n  }, [location, dispatch, categoryId, axios]);\n\n  const isValid = id => {\n    const isProductAdded = objProductCart.find(e => e.id === id);\n\n    if (!isProductAdded) {\n      const found = arr.find(e => e.id === id);\n      selectedProductHandler({\n        quantity: 1,\n        price: found.price,\n        productId: found.id,\n        shoppingCartId: openCart\n      });\n    }\n  };\n\n  const selectedProductHandler = async obj => {\n    // Selected product\n    try {\n      await axios.post('http://localhost:3001/productCart', obj);\n      dispatch({\n        type: 'SET_REFETCH_CART',\n        refetchCart: Math.random() * 2\n      });\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const incrementProductCart = async (productId, request) => {\n    // Change product amount\n    try {\n      await axios.put('http://localhost:3001/productCart', {\n        shoppingCartId: openCart,\n        productId: productId,\n        request: request\n      });\n      dispatch({\n        type: 'SET_REFETCH_CART',\n        refetchCart: Math.random() * 2\n      });\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"products-container\",\n    children: [searchStatus ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"search-result-box\",\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Search results for: \\\"\", searchStatus.searchWord, \"\\\" (\", searchStatus.resultsNumber, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 30\n    }, this) : null, /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: arr.map(e => {\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card-description\",\n            onClick: () => {\n              const isProduct = arr.find(k => k.id === e.id);\n\n              if (isProduct) {\n                dispatch({\n                  type: 'SET_SELECTED_PRODUCT',\n                  selectedProduct: isProduct\n                });\n                dispatch({\n                  type: 'SET_ADD_MODAL_STATE',\n                  addModalState: true\n                });\n              }\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"img-box\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"product-btn\",\n                id: e.id,\n                children: /*#__PURE__*/_jsxDEV(\"figure\", {\n                  children: [/*#__PURE__*/_jsxDEV(Image, {\n                    cloudName: \"itamarrosenblum\",\n                    publicId: e.img\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 111,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"figcaption\", {\n                    children: e.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 115,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 110,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"price-box\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"$\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 121,\n                  columnNumber: 40\n                }, this), e.price]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"btn-box\",\n            children: objProductCart && objProductCart.find(x => x.id === e.id) ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"quantity-box\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => incrementProductCart(e.id, 'reduce'),\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: /*#__PURE__*/_jsxDEV(IoRemoveOutline, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 131,\n                    columnNumber: 47\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: objProductCart.map(k => {\n                  return /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: k.id === e.id ? k.productCart.quantity : null\n                  }, k.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 136,\n                    columnNumber: 45\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 133,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => incrementProductCart(e.id, 'increment'),\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: /*#__PURE__*/_jsxDEV(IoAddOutline, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 143,\n                    columnNumber: 43\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 143,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"add-cart-btn\",\n              onClick: () => {\n                isValid(e.id);\n              },\n              children: \"Add to Cart\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 29\n          }, this)]\n        }, e.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 25\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this), addModalState ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(AddModal, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }, this) : null, disabledBg ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"disabled-bg\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 13\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Products, \"Ws3zMydYxwdh1C6om3iqPPhj2Wg=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useDispatch, useLocation];\n});\n\n_c = Products;\nexport default Products;\n\nvar _c;\n\n$RefreshReg$(_c, \"Products\");","map":{"version":3,"sources":["C:/xampp/htdocs/Ecommerce-Project/front-end/src/components/main/shelf/products/Products.jsx"],"names":["React","useState","useEffect","useDispatch","useSelector","useLocation","Image","IoAddOutline","IoRemoveOutline","AddModal","Products","categoryId","setCategoryId","arr","state","getProducts","openCart","getOpenCart","objProductCart","getProductCart","searchStatus","getSearchStatus","addModalState","getAddModalState","disabledBg","getDisabledBg","dispatch","location","axios","require","res","get","data","category","id","err","console","error","found","find","firstProduct","type","product","products","isValid","isProductAdded","e","selectedProductHandler","quantity","price","productId","shoppingCartId","obj","post","refetchCart","Math","random","incrementProductCart","request","put","searchWord","resultsNumber","map","isProduct","k","selectedProduct","img","name","x","productCart"],"mappings":"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","sourcesContent":["import './Products.css';\r\nimport './ProductQueries.css';\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { Image } from 'cloudinary-react';\r\nimport { IoAddOutline, IoRemoveOutline } from 'react-icons/io5';\r\nimport AddModal from '../addModal/AddModal';\r\n\r\nconst Products = () => {\r\n    const [categoryId, setCategoryId] = useState(0);\r\n    const arr = useSelector(state => state.getProducts);\r\n    const openCart = useSelector(state => state.getOpenCart);\r\n    const objProductCart = useSelector(state => state.getProductCart);\r\n    const searchStatus = useSelector(state => state.getSearchStatus);\r\n    const addModalState = useSelector(state => state.getAddModalState);\r\n    const disabledBg = useSelector(state => state.getDisabledBg);\r\n    const dispatch = useDispatch();\r\n    const location = useLocation();\r\n    const axios = require('axios');\r\n\r\n    useEffect(() => { // Fetch first category dynamically\r\n        (async () => {\r\n            try {\r\n                const res = await axios.get('http://localhost:3001/category');\r\n\r\n                setCategoryId(res.data.category.id);\r\n            } catch (err) {\r\n                console.error(err);\r\n            }\r\n        })();\r\n    }, [axios]);\r\n\r\n    useEffect(() => { // Fetch category dynamically\r\n        (async () => {\r\n            try {\r\n                const res = await axios.get(`http://localhost:3001/products/${location.id ? location.id : categoryId}`);\r\n\r\n                const found = res.data.data.find (firstProduct => firstProduct);\r\n                if(found) {\r\n                    dispatch({type: 'SET_PRODUCT', product: found});\r\n                    dispatch({type: 'SET_PRODUCTS', products: res.data.data});\r\n                    dispatch({type: 'SET_SEARCH_STATUS', searchStatus: null});\r\n                }\r\n            } catch (err) {\r\n                console.error(err);\r\n            }\r\n        })();\r\n    }, [location, dispatch, categoryId, axios]);\r\n\r\n    const isValid = (id) => {\r\n        const isProductAdded = objProductCart.find(e => e.id === id);\r\n\r\n        if (!isProductAdded) {\r\n            const found = arr.find(e => e.id === id);\r\n            selectedProductHandler({\r\n                quantity: 1,\r\n                price: found.price,\r\n                productId: found.id,\r\n                shoppingCartId: openCart\r\n            });\r\n        }\r\n    }\r\n\r\n    const selectedProductHandler = async (obj) => { // Selected product\r\n        try {\r\n            await axios.post('http://localhost:3001/productCart', obj);\r\n\r\n            dispatch({type: 'SET_REFETCH_CART', refetchCart: Math.random() * 2 });\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    }\r\n\r\n    const incrementProductCart = async (productId, request) => { // Change product amount\r\n        try {\r\n            await axios.put('http://localhost:3001/productCart', \r\n            {shoppingCartId: openCart, productId: productId, request: request});\r\n\r\n            dispatch({type: 'SET_REFETCH_CART', refetchCart: Math.random() * 2 });\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className='products-container'>\r\n            { searchStatus ? <div className='search-result-box'>\r\n                <h3>Search results for: &quot;{searchStatus.searchWord}&quot; ({searchStatus.resultsNumber})</h3>\r\n            </div> : null }\r\n            <ul>\r\n                {arr.map(e => {\r\n                    return(\r\n                        <li key={e.id}>\r\n                            <div\r\n                                className='card-description'\r\n                                onClick={() => {\r\n                                    const isProduct = arr.find(k => k.id === e.id);\r\n                                    if (isProduct) {\r\n                                        dispatch({type: 'SET_SELECTED_PRODUCT', selectedProduct: isProduct });\r\n                                        dispatch({type: 'SET_ADD_MODAL_STATE', addModalState: true });\r\n                                    }\r\n                                }}\r\n                            >\r\n                                <div className='img-box'>\r\n                                    <button \r\n                                        className='product-btn' \r\n                                        id={e.id}\r\n                                    >\r\n                                        <figure>\r\n                                            <Image \r\n                                                cloudName='itamarrosenblum'\r\n                                                publicId={e.img}\r\n                                            />\r\n                                            <figcaption>{e.name}</figcaption>\r\n                                        </figure>\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <div className='price-box'>\r\n                                    <p><span>&#36;</span>{e.price}</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className='btn-box'>\r\n                               { objProductCart && objProductCart.find(x => x.id === e.id) ?\r\n                                <div className='quantity-box'>\r\n                                    <button\r\n                                        onClick={() => incrementProductCart(e.id, 'reduce')}\r\n                                    >\r\n                                        <span><IoRemoveOutline /></span>\r\n                                    </button>\r\n                                    <div>\r\n                                    {objProductCart.map(k => {\r\n                                        return(\r\n                                            <span key={k.id}>{k.id ===e.id ? k.productCart.quantity : null}</span>\r\n                                           )\r\n                                       })}\r\n                                    </div>\r\n                                    <button \r\n                                        onClick={() => incrementProductCart(e.id, 'increment')}\r\n                                    >\r\n                                    <span><IoAddOutline /></span>\r\n                                    </button>\r\n                                </div> \r\n                                :\r\n                                <button className='add-cart-btn'\r\n                                 onClick={() => {\r\n                                    isValid(e.id);\r\n                                }}\r\n                                >\r\n                                    Add to Cart\r\n                                </button> }\r\n                            </div>\r\n                        </li>\r\n                    );\r\n                })}\r\n            </ul>\r\n            { addModalState ?\r\n            <div>\r\n                <AddModal />\r\n            </div> : null }\r\n\r\n            {disabledBg ? \r\n            <div className='disabled-bg'></div> \r\n            : null }\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Products;"]},"metadata":{},"sourceType":"module"}